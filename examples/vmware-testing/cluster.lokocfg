variable "dns_zone" {}
variable "dns_provider" {}
variable "ssh_public_keys" {}

variable "datacenter" {}
variable "datastore" {}
variable "compute_cluster" {}
variable "network" {}
variable "template" {}
variable "folder" {}

variable "asset_dir" {
  default = "./lokomotive-assets"
}

variable "pool_path" {
  default = "./pool"
}

variable "cluster_name" {
  default = "lokomotive-cluster"
}

variable "controller_ips" {
  default = [
    "192.168.50.10",
  ]
}

variable "worker_ips" {
  default = [
    "192.168.50.13",
  ]
}

variable "hosts_cidr" {
  default = "192.168.50.0/24"
}

variable "dns_servers" {
  default = [
    "192.168.50.1"
  ]
}

cluster "vmware" {
  asset_dir        = pathexpand(var.asset_dir)
  name             = var.cluster_name
  ssh_public_keys  = var.ssh_public_keys

  dns {
    zone     = var.dns_zone
    provider = var.dns_provider
  }

  datacenter              = var.datacenter
  datastore               = var.datastore
  compute_cluster         = var.compute_cluster
  network                 = var.network
  folder                  = var.folder

  controller_ip_addresses = var.controller_ips
  hosts_cidr              = var.hosts_cidr
  dns_servers             = var.dns_servers

  template = var.template

  worker_pool "my-wp-name" {
    ip_addresses    = var.worker_ips
    ssh_public_keys = var.ssh_public_keys
  }
}

component "metrics-server" {}

component "flatcar-linux-update-operator" {}
